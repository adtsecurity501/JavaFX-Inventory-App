<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<VBox xmlns:fx="http://javafx.com/fxml/1" fx:controller="assettracking.controller.ImagingSettingsController"
      spacing="15" style="-fx-padding: 20;" prefWidth="650.0">

    <Label styleClass="h4" text="Imaging Processor Settings"/>
    <Separator/>

    <TitledPane text="Connection Settings" collapsible="false">
        <VBox spacing="10" style="-fx-padding: 15;">
            <GridPane hgap="10" vgap="10">
                <columnConstraints>
                    <ColumnConstraints hgrow="NEVER" minWidth="200"/>
                    <ColumnConstraints hgrow="ALWAYS"/>
                </columnConstraints>

                <Label text="Full Outlook Folder Path:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                <TextField fx:id="folderNameField" promptText="e.g., \\Mailbox\Inbox\OSD Include" GridPane.rowIndex="0"
                           GridPane.columnIndex="1"/>

                <Label text="Email Subject Must Contain:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                <TextField fx:id="subjectFilterField" promptText="e.g., OSD Completion" GridPane.rowIndex="1"
                           GridPane.columnIndex="1"/>

                <Label text="IP Address Prefix Filter:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                <TextField fx:id="ipFilterField" promptText="e.g., 10.68.47." GridPane.rowIndex="2"
                           GridPane.columnIndex="1"/>

                <Label text="Auto-Refresh Interval (minutes):" GridPane.rowIndex="3" GridPane.columnIndex="0"/>
                <TextField fx:id="refreshIntervalField" promptText="e.g., 5" GridPane.rowIndex="3"
                           GridPane.columnIndex="1"/>
            </GridPane>
            <HBox alignment="CENTER_RIGHT" style="-fx-padding: 10 0 0 0;">
                <Button onAction="#handleTestConnection" text="Test Outlook Connection"/>
            </HBox>
        </VBox>
    </TitledPane>

    <TitledPane text="Advanced: Email Parsing Keywords" collapsible="false">
        <GridPane hgap="10" vgap="10" style="-fx-padding: 15;">
            <columnConstraints>
                <ColumnConstraints hgrow="NEVER" minWidth="200"/>
                <ColumnConstraints hgrow="ALWAYS"/>
            </columnConstraints>
            <Label text="Computer Name Keyword:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
            <TextField fx:id="computerNameKeywordField" disable="true" GridPane.rowIndex="0" GridPane.columnIndex="1"/>
            <Label text="(This is disabled because the computer name is now always taken from the email subject line.)"
                   wrapText="true" style="-fx-font-style: italic; -fx-text-fill: -color-fg-muted;"
                   GridPane.rowIndex="1" GridPane.columnIndex="1"/>
            <Label text="Serial Number Keyword:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
            <TextField fx:id="serialNumberKeywordField" GridPane.rowIndex="2" GridPane.columnIndex="1"/>

            <Label text="Reimage Time Keyword:" GridPane.rowIndex="3" GridPane.columnIndex="0"/>
            <TextField fx:id="reimageTimeKeywordField" GridPane.rowIndex="3" GridPane.columnIndex="1"/>

            <Label text="Failed Installs Keyword:" GridPane.rowIndex="4" GridPane.columnIndex="0"/>
            <TextField fx:id="failedInstallsKeywordField" GridPane.rowIndex="4" GridPane.columnIndex="1"/>
        </GridPane>
    </TitledPane>

    <HBox alignment="CENTER_RIGHT" spacing="10" style="-fx-padding: 20 0 0 0;">
        <Label fx:id="statusLabel" HBox.hgrow="ALWAYS" maxWidth="Infinity"
               style="-fx-font-weight: bold; -fx-text-fill: -color-success-fg;"/>
        <Button onAction="#handleSave" text="Save and Close" styleClass="success"/>
        <Button onAction="#handleCancel" text="Cancel"/>
    </HBox>
</VBox>